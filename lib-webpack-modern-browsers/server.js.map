{"version":3,"sources":["../src/server.jsx"],"names":[],"mappings":"AAAA,OAAO,KAAP,MAAkB,OAAlB;AACA,SAAS,cAAT,EAAyB,oBAAzB,QAAqD,kBAArD;AACA,OAAO,UAAP,MAAuB,OAAvB;;iBAEgB,O;iBAAT,G;;;AAEP,OAAO,SAAS,iBAAT,OAAyD;AAAA,QAA5B,GAA4B,QAA5B,GAA4B;AAAA,QAAvB,OAAuB,QAAvB,OAAuB;AAAA,QAAd,IAAc,QAAd,IAAc;AAAA,QAAR,IAAQ,QAAR,IAAQ;;AAC5D,UAAM,OAAO,UAAb;AACA,WAAO,eAAe;AAAC,WAAD;AAAA,UAAK,SAAS,OAAd;AAAuB,4BAAC,IAAD,EAAU,IAAV;AAAvB,KAAf,CAAP;AACH;;AAED,SAAS,MAAT,CAAgB,MAAhB,EAAwB,IAAxB,EAA8B;AAC1B,WAAO,oBAAC,MAAD,EAAY,IAAZ,CAAP;AACH;;AAED,SAAS,GAAT,QAA6E;AAAA,QAA9D,OAA8D,SAA9D,OAA8D;AAAA,QAArD,IAAqD,SAArD,IAAqD;AAAA,+BAA/C,QAA+C;AAAA,QAA/C,QAA+C,kCAApC,EAAoC;AAAA,QAAhC,IAAgC,SAAhC,IAAgC;AAAA,QAA1B,WAA0B,SAA1B,WAA0B;AAAA,QAAb,IAAa,SAAb,IAAa;AAAA,QAAP,GAAO,SAAP,GAAO;;AACzE,QAAM,MAAM,IAAI,GAAJ,EAAZ;AACA,eAAW,OAAO,MAAP,CAAc,QAAd,EAAwB,IAAxB,CAAX;;AAEA,QAAM,MAAM;AACR,gBAAQ,SAAS,IAAI,GAAJ,CAAQ,KAAR,CADT;AAER,kBAAU,SAAS,SAAS,KAAT,GAAiB,KAF5B;AAGR,iBAAS,CAAC,GAAD,EAAM,KAAN,KAAgB,SAAS,GAAT,IAAgB,KAHjC;AAIR;AAJQ,KAAZ;;AAOA,WAAO,MAAP,CAAc,QAAd,EAAwB;AACpB,cAAM,kBAAkB;AACpB,qBAAS,GADW;AAEpB,eAFoB;AAGpB,gBAHoB;AAIpB;AAJoB,SAAlB,CADc;AAOpB;AACA,qBAAa,CAAC,WAAD,GAAe,IAAf,GAAuB,OAAO,WAAP,KAAuB,UAAvB,GAAoC,aAApC,GAAoD,WARpE;AASpB,aAAK,MAAM,IAAN,CAAW,GAAX,EAAgB,IAAhB,CAAqB,EAArB;AATe,KAAxB;;AAYA,QAAM,SAAS,KAAK,MAAL,IAAe,IAA9B;AACA,QAAI,CAAC,MAAL,EAAa;AACT,cAAM,IAAI,KAAJ,CAAU,gBAAV,CAAN;AACH;;AAED,WAAO,OAAO,MAAP,EAAe,QAAf,EAAyB,GAAzB,CAAP;AACH;;AAED,eAAe,SAAS,MAAT,CAAgB,OAAhB,EAAyB;AACpC,WAAQ,qBAAmB,qBAAqB,IAAI,OAAJ,CAArB,CAAmC,GAA9D;AACH","file":"server.jsx","sourcesContent":["import React from 'react';\nimport { renderToString, renderToStaticMarkup } from 'react-dom/server';\nimport DefaultApp from './App';\n\nexport App from './App';\n\nexport function renderToStringApp({ App, context, View, data }) {\n    App = App || DefaultApp;\n    return renderToString(<App context={context}><View {...data} /></App>);\n}\n\nfunction layout(Layout, data) {\n    return <Layout {...data} />;\n}\n\nfunction app({ context, View, htmlData = {}, data, initialData, Html, App }) {\n    const css = new Set();\n    htmlData = Object.assign(htmlData, data);\n\n    const ctx = {\n        addCss: value => css.add(value),\n        setTitle: value => htmlData.title = value,\n        setMeta: (key, value) => htmlData[key] = value,\n        context,\n    };\n\n    Object.assign(htmlData, {\n        body: renderToStringApp({\n            context: ctx,\n            App,\n            View,\n            data,\n        }),\n        // eslint-disable-next-line no-nested-ternary\n        initialData: !initialData ? data : (typeof initialData === 'function' ? initialData() : initialData),\n        css: Array.from(css).join(''),\n    });\n\n    const Layout = View.Layout || Html;\n    if (!Layout) {\n        throw new Error('Invalid Layout');\n    }\n\n    return layout(Layout, htmlData, ctx);\n}\n\nexport default function render(options) {\n    return `<!doctype html>\\n${renderToStaticMarkup(app(options))}`;\n}\n"]}